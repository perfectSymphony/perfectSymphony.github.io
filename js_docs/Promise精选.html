<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Promise精选 | perfectSymphony</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/home.jpeg">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.ac52e467.css" as="style"><link rel="preload" href="/assets/js/app.40de69bf.js" as="script"><link rel="preload" href="/assets/js/2.0554630a.js" as="script"><link rel="preload" href="/assets/js/46.66b60a82.js" as="script"><link rel="prefetch" href="/assets/js/10.89e900ad.js"><link rel="prefetch" href="/assets/js/11.177199b8.js"><link rel="prefetch" href="/assets/js/12.373a1b4f.js"><link rel="prefetch" href="/assets/js/13.bdd71039.js"><link rel="prefetch" href="/assets/js/14.1f397fa0.js"><link rel="prefetch" href="/assets/js/15.d7d0a013.js"><link rel="prefetch" href="/assets/js/16.b437f9a6.js"><link rel="prefetch" href="/assets/js/17.1c2522d2.js"><link rel="prefetch" href="/assets/js/18.8662f727.js"><link rel="prefetch" href="/assets/js/19.a6d457c4.js"><link rel="prefetch" href="/assets/js/20.781f6fc6.js"><link rel="prefetch" href="/assets/js/21.6513ed13.js"><link rel="prefetch" href="/assets/js/22.76f157d7.js"><link rel="prefetch" href="/assets/js/23.6af203da.js"><link rel="prefetch" href="/assets/js/24.a2093e2f.js"><link rel="prefetch" href="/assets/js/25.8cf0ea31.js"><link rel="prefetch" href="/assets/js/26.1285c7fb.js"><link rel="prefetch" href="/assets/js/27.b6cf8360.js"><link rel="prefetch" href="/assets/js/28.11b80280.js"><link rel="prefetch" href="/assets/js/29.443f80e0.js"><link rel="prefetch" href="/assets/js/3.c8d627eb.js"><link rel="prefetch" href="/assets/js/30.065c6659.js"><link rel="prefetch" href="/assets/js/31.b742fb5f.js"><link rel="prefetch" href="/assets/js/32.b3b97b3d.js"><link rel="prefetch" href="/assets/js/33.662ad925.js"><link rel="prefetch" href="/assets/js/34.05b23aee.js"><link rel="prefetch" href="/assets/js/35.5870a4e8.js"><link rel="prefetch" href="/assets/js/36.4acd896b.js"><link rel="prefetch" href="/assets/js/37.96adfb34.js"><link rel="prefetch" href="/assets/js/38.4823016e.js"><link rel="prefetch" href="/assets/js/39.a2737009.js"><link rel="prefetch" href="/assets/js/4.b86112af.js"><link rel="prefetch" href="/assets/js/40.02fec075.js"><link rel="prefetch" href="/assets/js/41.4b2caf6f.js"><link rel="prefetch" href="/assets/js/42.078b08a2.js"><link rel="prefetch" href="/assets/js/43.da43b837.js"><link rel="prefetch" href="/assets/js/44.ba3d0451.js"><link rel="prefetch" href="/assets/js/45.30ae824f.js"><link rel="prefetch" href="/assets/js/47.296f8cc5.js"><link rel="prefetch" href="/assets/js/48.f1ca1058.js"><link rel="prefetch" href="/assets/js/49.4e804083.js"><link rel="prefetch" href="/assets/js/5.2a7aa8ae.js"><link rel="prefetch" href="/assets/js/50.7ac85e0f.js"><link rel="prefetch" href="/assets/js/51.81df994d.js"><link rel="prefetch" href="/assets/js/52.8bef61f0.js"><link rel="prefetch" href="/assets/js/53.7b7516ff.js"><link rel="prefetch" href="/assets/js/54.711bf70c.js"><link rel="prefetch" href="/assets/js/55.bd8ae68a.js"><link rel="prefetch" href="/assets/js/56.1a603bcc.js"><link rel="prefetch" href="/assets/js/57.94c019ad.js"><link rel="prefetch" href="/assets/js/58.8dff9a67.js"><link rel="prefetch" href="/assets/js/59.3aee78b3.js"><link rel="prefetch" href="/assets/js/6.c50df69f.js"><link rel="prefetch" href="/assets/js/60.bb875c74.js"><link rel="prefetch" href="/assets/js/61.a76319ad.js"><link rel="prefetch" href="/assets/js/62.cf77b66d.js"><link rel="prefetch" href="/assets/js/63.cd1ac3f1.js"><link rel="prefetch" href="/assets/js/64.accb2c67.js"><link rel="prefetch" href="/assets/js/65.cb4d7a3b.js"><link rel="prefetch" href="/assets/js/66.11d38b22.js"><link rel="prefetch" href="/assets/js/67.6b981cdf.js"><link rel="prefetch" href="/assets/js/68.aa99b466.js"><link rel="prefetch" href="/assets/js/69.38b9308a.js"><link rel="prefetch" href="/assets/js/7.f1376b7f.js"><link rel="prefetch" href="/assets/js/70.b31084dd.js"><link rel="prefetch" href="/assets/js/71.2e2156ca.js"><link rel="prefetch" href="/assets/js/72.bdb085ae.js"><link rel="prefetch" href="/assets/js/73.0f8ad657.js"><link rel="prefetch" href="/assets/js/74.b3593247.js"><link rel="prefetch" href="/assets/js/75.826abee4.js"><link rel="prefetch" href="/assets/js/76.e34c2cf0.js"><link rel="prefetch" href="/assets/js/77.48371004.js"><link rel="prefetch" href="/assets/js/78.3545c257.js"><link rel="prefetch" href="/assets/js/79.1a0443b8.js"><link rel="prefetch" href="/assets/js/8.1fbbb863.js"><link rel="prefetch" href="/assets/js/80.e9abe564.js"><link rel="prefetch" href="/assets/js/81.8f3ba470.js"><link rel="prefetch" href="/assets/js/82.a702d172.js"><link rel="prefetch" href="/assets/js/83.bf6a4199.js"><link rel="prefetch" href="/assets/js/84.677e9c31.js"><link rel="prefetch" href="/assets/js/85.f8559b17.js"><link rel="prefetch" href="/assets/js/86.e9a5d06b.js"><link rel="prefetch" href="/assets/js/87.372d5999.js"><link rel="prefetch" href="/assets/js/88.b40c09a1.js"><link rel="prefetch" href="/assets/js/89.2ec6c6f3.js"><link rel="prefetch" href="/assets/js/9.b49605e3.js"><link rel="prefetch" href="/assets/js/90.24dc82d1.js"><link rel="prefetch" href="/assets/js/91.dead7127.js"><link rel="prefetch" href="/assets/js/92.98edce78.js"><link rel="prefetch" href="/assets/js/93.40c82d47.js"><link rel="prefetch" href="/assets/js/94.e57db667.js"><link rel="prefetch" href="/assets/js/95.1352020f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ac52e467.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">perfectSymphony</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://www.cnblogs.com/myprogramer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/perfectSymphony/notes.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://www.cnblogs.com/myprogramer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/perfectSymphony/notes.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/html_docs/html相关面试题.html" class="sidebar-link">html相关面试题</a></li><li><a href="/html_docs/table使用总结.html" class="sidebar-link">table使用总结</a></li><li><a href="/html_docs/localStorage和sessionStorage区别.html" class="sidebar-link">localStorage和sessionStorage区别</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js_docs/变量提升必须注意的问题.html" class="sidebar-link">变量提升必须注意的问题</a></li><li><a href="/js_docs/typeof与instanceof区别.html" class="sidebar-link">typeof与instanceof区别</a></li><li><a href="/js_docs/call、apply和bind方法的用法以及区别.html" class="sidebar-link">call、apply和bind方法的用法以及区别</a></li><li><a href="/js_docs/Promise精选.html" class="active sidebar-link">Promise精选</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promise精选" class="sidebar-link">Promise精选</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#一、常见-promise-面试题" class="sidebar-link">一、常见 Promise 面试题</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promise-出现的原因" class="sidebar-link">Promise 出现的原因</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#什么是-promise" class="sidebar-link">什么是 Promise</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#代码书写比较" class="sidebar-link">代码书写比较</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#如何理解-promise" class="sidebar-link">如何理解 Promise</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promise的使用总结" class="sidebar-link">Promise的使用总结</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promsie-与事件循环" class="sidebar-link">Promsie 与事件循环</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promise-的升级" class="sidebar-link">Promise 的升级</a></li><li class="sidebar-sub-header"><a href="/js_docs/Promise精选.html#promise相关补充" class="sidebar-link">Promise相关补充:</a></li></ul></li></ul></li><li><a href="/js_docs/事件循环机制相关问题总结.html" class="sidebar-link">事件循环机制相关问题总结</a></li><li><a href="/js_docs/彻底搞懂JS中的prototype、__proto__与constructor.html" class="sidebar-link">彻底搞懂JS中的prototype、_proto_与constructor</a></li><li><a href="/js_docs/ES6遍历数组和对象的方法总结.html" class="sidebar-link">ES6遍历数组和对象的方法总结</a></li><li><a href="/js_docs/js基本数据类型有哪些，有什么区别？.html" class="sidebar-link">js基本数据类型有哪些，有什么区别？</a></li><li><a href="/js_docs/解决JavaScript中0.1+0.2不等于0.3的问题.html" class="sidebar-link">解决JavaScript中0.1+0.2不等于0.3的问题</a></li><li><a href="/js_docs/ES6中的Set和Map.html" class="sidebar-link">ES6中的Set和Map</a></li><li><a href="/js_docs/谈谈对闭包的理解.html" class="sidebar-link">谈谈对闭包的理解</a></li><li><a href="/js_docs/JS基础.html" class="sidebar-link">JS基础(初级)</a></li><li><a href="/js_docs/JS能力测评经典题总结.html" class="sidebar-link">JS能力测评经典题总结</a></li><li><a href="/js_docs/手写出场率极高的面试题.html" class="sidebar-link">手写出场率极高的面试题</a></li><li><a href="/js_docs/什么是纯函数.html" class="sidebar-link">什么是纯函数</a></li><li><a href="/js_docs/什么是函数柯里化.html" class="sidebar-link">什么是函数柯里化</a></li><li><a href="/js_docs/js判断变量是不是数组的方法.html" class="sidebar-link">js判断变量是不是数组的方法</a></li><li><a href="/js_docs/判断一个对象是否为空对象.html" class="sidebar-link">判断一个对象是否为空对象</a></li><li><a href="/js_docs/JavaScript的深拷贝与浅拷贝.html" class="sidebar-link">JavaScript的深拷贝与浅拷贝</a></li><li><a href="/js_docs/关于面向对象.html" class="sidebar-link">关于面向对象</a></li><li><a href="/js_docs/AMD、CMD、CommonJs到底是什么？它们有什么区别？.html" class="sidebar-link">AMD、CMD、CommonJs到底是什么？它们有什么区别？</a></li><li><a href="/js_docs/箭头函数与普通函数的区别.html" class="sidebar-link">箭头函数与普通函数的区别</a></li><li><a href="/js_docs/js判断是否为整数类型.html" class="sidebar-link">js判断是否为整数类型</a></li><li><a href="/js_docs/JavaScript实现数据双向绑定的三种方式.html" class="sidebar-link">JavaScript实现数据双向绑定的三种方式</a></li><li><a href="/js_docs/浏览器与Node的事件循环有何区别.html" class="sidebar-link">浏览器与Node的事件循环有何区别</a></li><li><a href="/js_docs/异步编程实现任务调度器.html" class="sidebar-link">异步编程实现任务调度器</a></li><li><a href="/js_docs/javascript面试题七问七答.html" class="sidebar-link">javascript面试题七问七答</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>uni-app</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NodeJS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GIT</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>跨域</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>架构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>概念篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>正则表达式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>移动直播</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>问题记录</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>语录篇</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="promise精选"><a href="#promise精选" class="header-anchor">#</a> Promise精选</h2> <h3 id="一、常见-promise-面试题"><a href="#一、常见-promise-面试题" class="header-anchor">#</a> 一、常见 Promise 面试题</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>了解 Promise 吗？
Promise 解决的痛点是什么？
Promise 解决的痛点还有其他方法可以解决吗？如果有，请列举。
Promise 如何使用？
Promise 常用的方法有哪些？它们的作用是什么？
Promise 在事件循环中的执行过程是怎样的？
Promise 的业界实现都有哪些？
能不能手写一个 Promise 的 polyfill。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="promise-出现的原因"><a href="#promise-出现的原因" class="header-anchor">#</a> Promise 出现的原因</h3> <p>在 Promise 出现以前，我们处理一个异步网络请求，大概是这样：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>// 请求 代表 一个异步网络调用。
// 请求结果 代表网络请求的响应。
请求1<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果1<span class="token punctuation">)</span><span class="token punctuation">{</span>
    处理请求结果1
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>看起来还不错。
但是，需求变化了，我们需要根据第一个网络请求的结果，再去执行第二个网络请求，代码大概如下</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>请求1<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果1<span class="token punctuation">)</span><span class="token punctuation">{</span>
    请求2<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果2<span class="token punctuation">)</span><span class="token punctuation">{</span>
        处理请求结果2
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>看起来也不复杂。
但是需求是永无止境的，于是乎出现了如下的代码</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>请求1<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果1<span class="token punctuation">)</span><span class="token punctuation">{</span>
    请求2<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果2<span class="token punctuation">)</span><span class="token punctuation">{</span>
        请求3<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果3<span class="token punctuation">)</span><span class="token punctuation">{</span>
            请求4<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果4<span class="token punctuation">)</span><span class="token punctuation">{</span>
                请求5<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果5<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    请求6<span class="token punctuation">(</span>function<span class="token punctuation">(</span>请求结果3<span class="token punctuation">)</span><span class="token punctuation">{</span>
                        <span class="token punctuation">..</span>.
                    <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>这回傻眼了。。。 臭名昭著的 回调地狱 现身了。</p> <p>更糟糕的是，我们基本上还要对每次请求的结果进行一些处理，代码会更加臃肿，在一个团队中，代码 review 以及后续的维护将会是一个很痛苦的过程。</p> <p>回调地狱带来的负面作用有以下几点：</p> <ul><li>代码臃肿。</li> <li>可读性差。</li> <li>耦合度过高，可维护性差。</li> <li>代码复用性差。</li> <li>容易滋生 bug。</li> <li>只能在回调里处理异常。</li></ul> <p>出现了问题，自然就会有人去想办法。这时，就有人思考了，能不能用一种更加友好的代码组织方式，解决异步嵌套的问题。</p> <p>let 请求结果1 = 请求1();
let 请求结果2 = 请求2(请求结果1);
let 请求结果3 = 请求3(请求结果2);
let 请求结果4 = 请求2(请求结果3);
let 请求结果5 = 请求3(请求结果4);</p> <p>类似上面这种同步的写法。 于是 Promise 规范诞生了，并且在业界有了很多实现来解决回调地狱的痛点。比如业界著名的 Q 和 bluebird，bluebird 甚至号称运行最快的类库。</p> <blockquote><p>看到这里，对于上面的问题 2 和问题 7 ，心中是否有了答案呢。</p></blockquote> <h3 id="什么是-promise"><a href="#什么是-promise" class="header-anchor">#</a> 什么是 Promise</h3> <p>Promise 是异步编程的一种解决方案，比传统的异步解决方案【回调函数】和【事件】更合理、更强大。现已被 ES6 纳入进规范中。</p> <h3 id="代码书写比较"><a href="#代码书写比较" class="header-anchor">#</a> 代码书写比较</h3> <p>还是使用上面的网络请求例子，我们看下 Promise 的常规写法：</p> <p>new Promise(请求1)
.then(请求2(请求结果1))
.then(请求3(请求结果2))
.then(请求4(请求结果3))
.then(请求5(请求结果4))
.catch(处理异常(异常信息))</p> <p>比较一下这种写法和上面的回调式的写法。我们不难发现，Promise 的写法更为直观，并且能够在外层捕获异步函数的异常信息。</p> <h3 id="api"><a href="#api" class="header-anchor">#</a> API</h3> <p>Promise 的常用 API 如下：</p> <ul><li>Promise.resolve(value)</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>类方法，该方法返回一个以 value 值解析后的 Promise 对象
<span class="token number">1</span>、如果这个值是个 thenable（即带有 <span class="token keyword">then</span> 方法），返回的 Promise 对象会“跟随”这个 thenable 的对象，采用它的最终状态（指 resolved/rejected/pending/settled）
<span class="token number">2</span>、如果传入的 value 本身就是 Promise 对象，则该对象作为 Promise.resolve 方法的返回值返回。
<span class="token number">3</span>、其他情况以该值为成功状态返回一个 Promise 对象。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面是 resolve 方法的解释，传入不同类型的 value 值，返回结果也有区别。这个 API 比较重要，建议大家通过练习一些小例子，并且配合上面的解释来熟悉它。如下几个小例子：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//如果传入的 value 本身就是 Promise 对象，则该对象作为 Promise.resolve 方法的返回值返回。  
<span class="token keyword">function</span> fn<span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">{</span>
    setTimeout<span class="token punctuation">(</span><span class="token function-name function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        resolve<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,3000<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token builtin class-name">let</span> p0 <span class="token operator">=</span> new Promise<span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin class-name">let</span> p1 <span class="token operator">=</span> Promise.resolve<span class="token punctuation">(</span>p0<span class="token punctuation">)</span><span class="token punctuation">;</span>
// 返回为true，返回的 Promise 即是 入参的 Promise 对象。
console.log<span class="token punctuation">(</span>p0 <span class="token operator">==</span><span class="token operator">=</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>传入 thenable 对象，返回 Promise 对象跟随 thenable 对象的最终状态。</p> <blockquote><p>ES6 Promises 里提到了 Thenable 这个概念，简单来说它就是一个非常类似 Promise 的东西。最简单的例子就是 jQuery.ajax，它的返回值就是 thenable 对象。但是要谨记，并不是只要实现了 then 方法就一定能作为 Promise 对象来使用。</p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//如果传入的 value 本身就是 thenable 对象，返回的 promise 对象会跟随 thenable 对象的状态。
<span class="token builtin class-name">let</span> promise <span class="token operator">=</span> Promise.resolve<span class="token punctuation">(</span>$.ajax<span class="token punctuation">(</span><span class="token string">'/test/test.json'</span><span class="token punctuation">))</span><span class="token punctuation">;</span>// <span class="token operator">=</span><span class="token operator">&gt;</span> promise对象
promise.then<span class="token punctuation">(</span>function<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
   console.log<span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>返回一个状态已变成 resolved 的 Promise 对象。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">let</span> p1 <span class="token operator">=</span> Promise.resolve<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
//打印p1 可以看到p1是一个状态置为resolved的Promise对象
console.log<span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Promise.reject</li></ul> <blockquote><p>类方法，且与 resolve 唯一的不同是，返回的 promise 对象的状态为 rejected。</p></blockquote> <ul><li>Promise.prototype.then</li></ul> <blockquote><p>实例方法，为 Promise 注册回调函数，函数形式：fn(vlaue){}，value 是上一个任务的返回结果，then 中的函数一定要 return 一个结果或者一个新的 Promise 对象，才可以让之后的then 回调接收。</p></blockquote> <ul><li>Promise.prototype.catch</li></ul> <blockquote><p>实例方法，捕获异常，函数形式：fn(err){}, err 是 catch 注册 之前的回调抛出的异常信息。</p></blockquote> <ul><li>Promise.race</li></ul> <blockquote><p>类方法，多个 Promise 任务同时执行，返回最先执行结束的 Promise 任务的结果，不管这个 Promise 结果是成功还是失败。</p></blockquote> <ul><li>Promise.all</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>类方法，多个 Promise 任务同时执行。
如果全部成功执行，则以数组的方式返回所有 Promise 任务的执行结果。 如果有一个 Promise 任务 rejected，则只返回 rejected 任务的结果。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="如何理解-promise"><a href="#如何理解-promise" class="header-anchor">#</a> 如何理解 Promise</h3> <p>为了便于理解 Promise，大家除了要多加练习以外，最好的方式是能够将Promise的机制与现实生活中的例子联系起来，这样才能真正得到消化。
  我们可以把 Promise 比作一个保姆，家里的一连串的事情，你只需要吩咐给他，他就能帮你做，你就可以去做其他事情了。
  比如，某一天要出门办事，但是我还要买菜做饭送到老婆单位。
  出门办的事情很重要，买菜做饭也重要。但我自己只能做一件事。
这时我就可以把买菜做饭的事情交给保姆，我会告诉她：</p> <ul><li>你先去超市买菜。</li> <li>用超市买回来的菜做饭。</li> <li>将做好的饭菜送到老婆单位。</li> <li>送到单位后打电话告诉我。
我们知道，上面三步都是需要消耗时间的，我们可以理解为三个异步任务。利用 Promise 的写法来书写这个操作：</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">function</span> 买菜<span class="token punctuation">(</span>resolve，reject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    setTimeout<span class="token punctuation">(</span><span class="token function-name function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        resolve<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'西红柿'</span>、<span class="token string">'鸡蛋'</span>、<span class="token string">'油菜'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>,3000<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> 做饭<span class="token punctuation">(</span>resolve, reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
    setTimeout<span class="token punctuation">(</span><span class="token function-name function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        //对做好的饭进行下一步处理。
        resolve <span class="token punctuation">(</span><span class="token punctuation">{</span>
            主食: <span class="token string">'米饭'</span>,
            菜: <span class="token punctuation">[</span><span class="token string">'西红柿炒鸡蛋'</span>、<span class="token string">'清炒油菜'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>,3000<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
<span class="token keyword">function</span> 送饭<span class="token punctuation">(</span>resolve，reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
    //对送饭的结果进行下一步处理
    resolve<span class="token punctuation">(</span><span class="token string">'老婆的么么哒'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> 电话通知我<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    //电话通知我后的下一步处理
    给保姆加100块钱奖金<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>好了，现在我整理好了四个任务，这时我需要告诉保姆，让他按照这个任务列表去做。这个过程是必不可少的，因为如果不告诉保姆，保姆不知道需要做这些事情。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
// 告诉保姆帮我做几件连贯的事情，先去超市买菜
new Promise<span class="token punctuation">(</span>买菜<span class="token punctuation">)</span>
//用买好的菜做饭
.then<span class="token punctuation">((</span>买好的菜<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">return</span> new Promise<span class="token punctuation">(</span>做饭<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
//把做好的饭送到老婆公司
.then<span class="token punctuation">((</span>做好的饭<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">return</span> new Promise<span class="token punctuation">(</span>送饭<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
//送完饭后打电话通知我
.then<span class="token punctuation">((</span>送饭结果<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
    电话通知我<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>至此，我通知了保姆要做这些事情，然后我就可以放心地去办我的事情。</p> <blockquote><p>请一定要谨记：如果我们的后续任务是异步任务的话，必须return 一个 新的 promise 对象。
如果后续任务是同步任务，只需 return 一个结果即可。
我们上面举的例子，除了电话通知我是一个同步任务，其余的都是异步任务，异步任务 return 的是 promise对象。</p></blockquote> <p>除此之外，一定谨记，一个 Promise 对象有三个状态，并且状态一旦改变，便不能再被更改为其他状态。</p> <ul><li>pending，异步任务正在进行。</li> <li>resolved (也可以叫fulfilled)，异步任务执行成功。</li> <li>rejected，异步任务执行失败。</li></ul> <h3 id="promise的使用总结"><a href="#promise的使用总结" class="header-anchor">#</a> Promise的使用总结</h3> <p>Promise 这么多概念，初学者很难一下子消化掉，那么我们可以采取强制记忆法，强迫自己去记住使用过程。</p> <ul><li><p>首先初始化一个 Promise 对象，可以通过两种方式创建， 这两种方式都会返回一个 Promise 对象。</p></li> <li><p>1、new Promise(fn)</p></li> <li><p>2、Promise.resolve(fn)</p></li> <li><p>然后调用上一步返回的 promise 对象的 then 方法，注册回调函数。</p></li> <li><p>then 中的回调函数可以有一个参数，也可以不带参数。如果 then 中的回调函数依赖上一步的返回结果，那么要带上参数。比如:</p></li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>    new Promise<span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
    .then<span class="token punctuation">(</span>fn1<span class="token punctuation">(</span>value）<span class="token punctuation">{</span>
        //处理value
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>最后注册 catch 异常处理函数，处理前面回调中可能抛出的异常。</li></ul> <p>通常按照这三个步骤，你就能够应对绝大部分的异步处理场景。用熟之后，再去研究 Promise 各个函数更深层次的原理以及使用方式即可。</p> <p>看到这里之后，我们便能回答上面的问题 4 和问题 5了。</p> <h3 id="promsie-与事件循环"><a href="#promsie-与事件循环" class="header-anchor">#</a> Promsie 与事件循环</h3> <p>Promise在初始化时，传入的函数是同步执行的，然后注册 then 回调。注册完之后，继续往下执行同步代码，在这之前，then 中回调不会执行。同步代码块执行完毕后，才会在事件循环中检测是否有可用的 promise 回调，如果有，那么执行，如果没有，继续下一个事件循环。</p> <p>关于 Promise 在事件循环中还有一个 微任务的概念(microtask)，感兴趣的话可以看另外一篇关于nodejs 时间循环的文章 <a href="https://juejin.cn/post/6844903621444763662" target="_blank" rel="noopener noreferrer">剖析nodejs的事件循环<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，虽然和浏览器端有些不同，但是Promise 微任务的执行时机相差不大。</p> <h3 id="promise-的升级"><a href="#promise-的升级" class="header-anchor">#</a> Promise 的升级</h3> <p>ES6 出现了 generator 以及 async/await 语法，使异步处理更加接近同步代码写法，可读性更好，同时异常捕获和同步代码的书写趋于一致。上面的列子可以写成这样：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">(</span>async <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>
  <span class="token builtin class-name">let</span> 蔬菜 <span class="token operator">=</span> await 买菜<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin class-name">let</span> 饭菜 <span class="token operator">=</span> await 做饭<span class="token punctuation">(</span>蔬菜<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin class-name">let</span> 送饭结果 <span class="token operator">=</span> await 送饭<span class="token punctuation">(</span>饭菜<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin class-name">let</span> 通知结果 <span class="token operator">=</span> await 通知我<span class="token punctuation">(</span>送饭结果<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>需要记住的是，async/await也是基于 Promise 实现的，所以，我们有必要深入理解 Promise 的用法。</p> <h3 id="promise相关补充"><a href="#promise相关补充" class="header-anchor">#</a> Promise相关补充:</h3> <p>1、</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  new Promise<span class="token punctuation">(</span>function<span class="token punctuation">(</span>resolve,reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console.log<span class="token punctuation">(</span><span class="token string">&quot;promise start...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    var <span class="token function">timeout</span> <span class="token operator">=</span> Math.random<span class="token punctuation">(</span><span class="token punctuation">)</span>*2<span class="token punctuation">;</span>   //0-2
    console.log<span class="token punctuation">(</span><span class="token string">&quot;set timeout to：&quot;</span> + <span class="token function">timeout</span> + <span class="token string">&quot;seconds&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    setTimeout<span class="token punctuation">(</span><span class="token function-name function">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      if<span class="token punctuation">(</span>timeout <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console.log<span class="token punctuation">(</span><span class="token string">&quot;call resolve()...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resolve<span class="token punctuation">(</span><span class="token string">&quot;200 ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>else<span class="token punctuation">{</span>
        console.log<span class="token punctuation">(</span><span class="token string">&quot;call reject()...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reject<span class="token punctuation">(</span><span class="token string">&quot;timeout in&quot;</span> + <span class="token function">timeout</span> + <span class="token string">&quot;seconds&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>,timeout * <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>.then<span class="token punctuation">(</span>function<span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console.log<span class="token punctuation">(</span><span class="token string">&quot;Done：&quot;</span> + resolve<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>.catch<span class="token punctuation">(</span>function<span class="token punctuation">(</span>reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console.log<span class="token punctuation">(</span><span class="token string">&quot;Failed：&quot;</span> + reject<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>可见Promise最大的好处是在异步执行的流程中，把执行代码和处理结果的代码清晰地分离了。</p> <p>2、任何任务失败则不再继续并执行错误处理函数。
要串行执行这样的异步任务，不需要写一层一层的嵌套代码。有了Promise，我们只需要简单地写：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">function</span> multi<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">return</span> new Promise<span class="token punctuation">(</span>function<span class="token punctuation">(</span>resolve,reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console.log<span class="token punctuation">(</span><span class="token string">'计算 '</span> + input + <span class="token string">' x '</span> + input + <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        setTimeout<span class="token punctuation">(</span>resolve,500, input * input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> add<span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token builtin class-name">return</span> new Promise<span class="token punctuation">(</span>function<span class="token punctuation">(</span>resolve,reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
        console.log<span class="token punctuation">(</span><span class="token string">'计算 '</span> + input + <span class="token string">' + '</span> + input + <span class="token string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        setTimeout<span class="token punctuation">(</span>resolve,500,input + input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
var p <span class="token operator">=</span> new Promise<span class="token punctuation">(</span>function<span class="token punctuation">(</span>resolve,reject<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console.log<span class="token punctuation">(</span><span class="token string">&quot;start ....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    resolve<span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p.then<span class="token punctuation">(</span>multi<span class="token punctuation">)</span>
 .then<span class="token punctuation">(</span>add<span class="token punctuation">)</span>
 .then<span class="token punctuation">(</span>multi<span class="token punctuation">)</span>
 .then<span class="token punctuation">(</span>add<span class="token punctuation">)</span>
 .then<span class="token punctuation">(</span>function<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console.log<span class="token punctuation">(</span><span class="token string">&quot;结果：&quot;</span> + result<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/perfectSymphony/notes/edit/master/docs/js_docs/Promise精选.md" target="_blank" rel="noopener noreferrer">在GitHub上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">4/11/2021, 10:21:13 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js_docs/call、apply和bind方法的用法以及区别.html" class="prev">
        call、apply和bind方法的用法以及区别
      </a></span> <span class="next"><a href="/js_docs/事件循环机制相关问题总结.html">
        事件循环机制相关问题总结
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.40de69bf.js" defer></script><script src="/assets/js/2.0554630a.js" defer></script><script src="/assets/js/46.66b60a82.js" defer></script>
  </body>
</html>
